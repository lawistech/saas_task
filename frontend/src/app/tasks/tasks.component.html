<div class="tasks-container">
  <div class="tasks-header">
    <div class="header-left">
      <h1>Task Management</h1>
      <div class="view-toggle">
        <button
          class="view-btn"
          [class.active]="viewMode === 'list'"
          (click)="viewMode = 'list'; loadTasks(activeFilter || undefined)">
          <i class="icon">📋</i> List View
        </button>
        <button
          class="view-btn"
          [class.active]="viewMode === 'pipeline'"
          (click)="viewMode = 'pipeline'; loadTasks(activeFilter || undefined)">
          <i class="icon">📊</i> Pipeline View
        </button>
      </div>
    </div>
    <button class="add-task-btn" (click)="openTaskForm()">
      <i class="icon">➕</i> Add New Task
    </button>
  </div>

  <div class="task-filters" *ngIf="viewMode === 'list'">
    <button
      class="filter-btn"
      [class.active]="activeFilter === null"
      (click)="loadTasks()">
      All
    </button>
    <button
      class="filter-btn"
      [class.active]="activeFilter === 'pending'"
      (click)="loadTasks('pending')">
      Pending
    </button>
    <button
      class="filter-btn"
      [class.active]="activeFilter === 'in_progress'"
      (click)="loadTasks('in_progress')">
      In Progress
    </button>
    <button
      class="filter-btn"
      [class.active]="activeFilter === 'completed'"
      (click)="loadTasks('completed')">
      Completed
    </button>
  </div>

  <div *ngIf="isLoading" class="loading-indicator">
    Loading tasks...
  </div>

  <!-- List View -->
  <app-task-list
    *ngIf="!isLoading && viewMode === 'list'"
    [tasks]="tasks"
    (editTask)="openTaskForm($event)"
    (deleteTask)="onTaskDeleted($event)"
    (taskStatusChanged)="onTaskStatusChanged($event)">
  </app-task-list>

  <!-- Pipeline View -->
  <app-task-pipeline
    *ngIf="!isLoading && viewMode === 'pipeline'"
    [tasks]="tasks"
    (editTask)="openTaskForm($event)"
    (deleteTask)="onTaskDeleted($event)"
    (taskStatusChanged)="onTaskStatusChanged($event)">
  </app-task-pipeline>

  <div *ngIf="!isLoading && tasks.length === 0" class="no-tasks">
    <p>No tasks found. Create a new task to get started!</p>
  </div>

  <app-task-form
    *ngIf="showTaskForm"
    [task]="selectedTask"
    (close)="closeTaskForm()"
    (saved)="onTaskSaved()">
  </app-task-form>
</div>
